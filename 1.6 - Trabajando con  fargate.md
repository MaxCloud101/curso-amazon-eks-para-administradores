# Introducci칩n
En este capitulo vamos a trabajando con Fargate.

## En acci칩n: Creando un cluster y desplegando una aplicacion simple

1.- Vamos al servio de AWS CloudShell

2.- Creamos un archivo y lo editamos con nano

```
nano fargate-cluster.yaml
```
Colocamos el siguiente contenido en el archivo

```
apiVersion: eksctl.io/v1alpha5
kind: ClusterConfig

metadata:
  name: fargate-cluster
  region: us-west-2

fargateProfiles:
  - name: fp-default
    selectors:
      # Todas las cargas de trabajo en el espacio de nombres "predeterminado" de Kubernetes se programar치n en Fargate:
      - namespace: default
      # Todas las cargas de trabajo en el espacio de nombres de Kubernetes "kube-system" se programar치n en Fargate:
      - namespace: kube-system
```

3.- Creamos el cluster con eksctl. Asi que lanzamos el siguiente comando:
```
eksctl create cluster -f fargate-cluster.yaml
```
![Verificar versiones](/img/7-1.image.jpg)

4.- Revisamos los node groups del cluster
```
eksctl get nodegroups --cluster fargate-cluster
```

5.- Creamos un archivo con un deployment y lo editamos con nano

```
nano myapp.yaml
```
Colocamos el siguiente contenido en el archivo

```
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: default
  name: myapp
  labels:
      app: myapp
spec:
  replicas: 2
  selector:
    matchLabels:
      app: myapp
  template: 
    metadata:
      labels: 
        app: myapp
    spec:
      containers:
      - name: nginx
        image: nginx
        ports:
        - containerPort: 80
```

6.- Lanzamos el deployment y el service siguiente comando:
```
kubectl apply -f myapp.yaml
```
7.- Esperamos unos minutos y revisamos que el deployment se haya desplegado correctamente
```
kubectl get pods
```
![Verificar versiones](/img/7-2.image.jpg)

8.- Eliminamos la aplicacion desplegada
```
kubectl delete -f myapp.yaml
```
9.- Despues de verificar que todo este correcto eliminamos el cluster.
```
eksctl delete cluster -f fargate-cluster.yaml --disable-nodegroup-eviction












